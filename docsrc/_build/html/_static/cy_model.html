<!DOCTYPE html>
<!-- Generated by Cython 0.29.20 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: cy_model.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.20</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="cy_model.c">cy_model.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: #!python</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: #cython: boundscheck=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: #cython: cdivision=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: #cython: infertypes=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: #cython: initializedcheck=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: #cython: nonecheck=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: #cython: wraparound=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: #distutils: language = c</pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: #distutils: extra_link_args = ['-lgsl', '-lgslcblas', '-fopenmp']</pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: #distutils: extra_compile_args = -Wno-unused-function -Wno-unneeded-internal-declaration -Wno-nonnull -Wno-nullability-completeness</pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">012</span>: import logging</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_logging, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_logging, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">014</span>: cimport numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: cimport cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: from cython.parallel import prange</pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: # Abbreviate numpy dtypes</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>: DTYPE_FLOAT = np.float64</pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE_FLOAT, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">020</span>: DTYPE_INT = np.intc</pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE_INT, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: # isinf from C math.h</pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: cdef extern from "math.h" nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>:     unsigned int isinf(double f)</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: # Random generator from GSL lib</pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: cdef extern from "gsl/gsl_rng.h" nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>:     ctypedef struct gsl_rng_type:</pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>:         pass</pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>:     ctypedef struct gsl_rng:</pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>:         pass</pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>:     gsl_rng_type *gsl_rng_mt19937</pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>:     gsl_rng *gsl_rng_alloc(gsl_rng_type * T)</pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>:     void gsl_rng_set(gsl_rng * r, unsigned long int)</pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>:     void gsl_rng_free(gsl_rng * r)</pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: # Poisson distribution from GSL lib</pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: cdef extern from "gsl/gsl_randist.h" nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>:     unsigned int gsl_ran_poisson(gsl_rng * r, double mu)</pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>: cdef gsl_rng *get_seeded_rng(int int_seed) nogil:</pre>
<pre class='cython code score-0 '>static gsl_rng *__pyx_f_8SEIRcity_5model_8cy_model_get_seeded_rng(int __pyx_v_int_seed) {
  gsl_rng *__pyx_v_rng;
  gsl_rng *__pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">043</span>:     """Returns a C pointer to instance of MT-19937 generator</pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:     (https://www.gnu.org/software/gsl/doc/html/rng.html#c.gsl_rng_mt19937).</pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>:     Seeds with int32 seed `int_seed`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>:     cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:         gsl_rng *rng = gsl_rng_alloc(gsl_rng_mt19937)</pre>
<pre class='cython code score-0 '>  __pyx_v_rng = gsl_rng_alloc(gsl_rng_mt19937);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:     gsl_rng_set(rng, int_seed)</pre>
<pre class='cython code score-0 '>  gsl_rng_set(__pyx_v_rng, __pyx_v_int_seed);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>:     return rng</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_rng;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: </pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>: def test_gsl_poisson(double mu, int int_seed, int iters, int enable_omp):</pre>
<pre class='cython code score-87 '>/* Python wrapper */
static PyObject *__pyx_pw_8SEIRcity_5model_8cy_model_1test_gsl_poisson(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8SEIRcity_5model_8cy_model_test_gsl_poisson[] = "For testing purposes only\n    ";
static PyMethodDef __pyx_mdef_8SEIRcity_5model_8cy_model_1test_gsl_poisson = {"test_gsl_poisson", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8SEIRcity_5model_8cy_model_1test_gsl_poisson, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8SEIRcity_5model_8cy_model_test_gsl_poisson};
static PyObject *__pyx_pw_8SEIRcity_5model_8cy_model_1test_gsl_poisson(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_mu;
  int __pyx_v_int_seed;
  int __pyx_v_iters;
  int __pyx_v_enable_omp;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test_gsl_poisson (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mu,&amp;__pyx_n_s_int_seed,&amp;__pyx_n_s_iters,&amp;__pyx_n_s_enable_omp,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mu)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_int_seed)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_gsl_poisson", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iters)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_gsl_poisson", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_enable_omp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_gsl_poisson", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "test_gsl_poisson") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_mu = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_mu == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
    __pyx_v_int_seed = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_int_seed == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
    __pyx_v_iters = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_iters == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
    __pyx_v_enable_omp = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_enable_omp == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test_gsl_poisson", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("SEIRcity.model.cy_model.test_gsl_poisson", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8SEIRcity_5model_8cy_model_test_gsl_poisson(__pyx_self, __pyx_v_mu, __pyx_v_int_seed, __pyx_v_iters, __pyx_v_enable_omp);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8SEIRcity_5model_8cy_model_test_gsl_poisson(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_mu, int __pyx_v_int_seed, int __pyx_v_iters, int __pyx_v_enable_omp) {
  gsl_rng *__pyx_v_rng;
  CYTHON_UNUSED Py_ssize_t __pyx_v_iter_len;
  Py_ssize_t __pyx_v_i;
  PyArrayObject *__pyx_v_result_arr = 0;
  __Pyx_memviewslice __pyx_v_rv = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test_gsl_poisson", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("SEIRcity.model.cy_model.test_gsl_poisson", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_result_arr);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rv, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_mu, __pyx_n_s_int_seed, __pyx_n_s_iters, __pyx_n_s_enable_omp, __pyx_n_s_rng, __pyx_n_s_iter_len, __pyx_n_s_i, __pyx_n_s_result_arr, __pyx_n_s_rv);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_8SEIRcity_5model_8cy_model_1test_gsl_poisson, NULL, __pyx_n_s_SEIRcity_model_cy_model);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test_gsl_poisson, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__30 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_SEIRcity_model_cy_model_pyx, __pyx_n_s_test_gsl_poisson, 53, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">054</span>:     """For testing purposes only</pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>:     cdef:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>:         gsl_rng *rng = get_seeded_rng(int_seed)</pre>
<pre class='cython code score-0 '>  __pyx_v_rng = __pyx_f_8SEIRcity_5model_8cy_model_get_seeded_rng(__pyx_v_int_seed);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:         Py_ssize_t iter_len = iters</pre>
<pre class='cython code score-0 '>  __pyx_v_iter_len = __pyx_v_iters;
</pre><pre class="cython line score-0">&#xA0;<span class="">059</span>:         Py_ssize_t i</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:         np.ndarray result_arr = np.zeros((iters), dtype=DTYPE_INT)</pre>
<pre class='cython code score-30 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_iters);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE_INT);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  __pyx_v_result_arr = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:         int [:] rv = result_arr</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(((PyObject *)__pyx_v_result_arr), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  __pyx_v_rv = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">062</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>:     if enable_omp == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((__pyx_v_enable_omp == 0) != 0);
  if (__pyx_t_6) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>:         for i in range(iters):</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_iters;
    __pyx_t_8 = __pyx_t_7;
    for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">065</span>:             rv[i] = gsl_ran_poisson(rng, mu)</pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_i;
      *((int *) ( /* dim=0 */ (__pyx_v_rv.data + __pyx_t_10 * __pyx_v_rv.strides[0]) )) = gsl_ran_poisson(__pyx_v_rng, __pyx_v_mu);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">066</span>:     else:</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">067</span>:         for i in prange(iters, nogil=True):</pre>
<pre class='cython code score-4 '>  /*else*/ {
    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
          __pyx_t_7 = __pyx_v_iters;
          if ((1 == 0)) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_11 = (__pyx_t_7 - 0 + 1 - 1/abs(1)) / 1;
              if (__pyx_t_11 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)
                      #endif /* _OPENMP */
                      for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_11; __pyx_t_9++){
                          {
                              __pyx_v_i = (Py_ssize_t)(0 + 1 * __pyx_t_9);
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L8;
          }
          __pyx_L8:;
        }
    }
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">068</span>:             rv[i] = gsl_ran_poisson(rng, mu)</pre>
<pre class='cython code score-0 '>                              __pyx_t_12 = __pyx_v_i;
                              *((int *) ( /* dim=0 */ (__pyx_v_rv.data + __pyx_t_12 * __pyx_v_rv.strides[0]) )) = gsl_ran_poisson(__pyx_v_rng, __pyx_v_mu);
                          }
                      }
                  }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:     return result_arr</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_result_arr));
  __pyx_r = ((PyObject *)__pyx_v_result_arr);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">072</span>: cdef double discrete_time_approx(double rate, double timestep) nogil:</pre>
<pre class='cython code score-0 '>static double __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx(double __pyx_v_rate, double __pyx_v_timestep) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">073</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>:     :param rate: daily rate</pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>:     :param timestep: timesteps per day</pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>:     :return: rate rescaled by time step</pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>:     # if rate &gt;= 1:</pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>:         # return np.nan</pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>:     # elif timestep == 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>:         # return np.nan</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:     return (1 - (1 - rate)**(1/timestep))</pre>
<pre class='cython code score-0 '>  __pyx_r = (1.0 - pow((1.0 - __pyx_v_rate), (1.0 / __pyx_v_timestep)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">083</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>: cdef np.ndarray SEIR_intra_node(double [:, :, :, :, :] ntwk_v,</pre>
<pre class='cython code score-11 '>static PyArrayObject *__pyx_f_8SEIRcity_5model_8cy_model_SEIR_intra_node(__Pyx_memviewslice __pyx_v_ntwk_v, __Pyx_memviewslice __pyx_v_phi_v, double __pyx_v_int_per_day, gsl_rng *__pyx_v_rng) {
  Py_ssize_t __pyx_v_node_len;
  Py_ssize_t __pyx_v_age_len;
  Py_ssize_t __pyx_v_risk_len;
  CYTHON_UNUSED Py_ssize_t __pyx_v_vt_len;
  Py_ssize_t __pyx_v_compt_len;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_a;
  Py_ssize_t __pyx_v_r;
  Py_ssize_t __pyx_v_a_2;
  Py_ssize_t __pyx_v_r_2;
  PyArrayObject *__pyx_v_compt_counts = 0;
  __Pyx_memviewslice __pyx_v_compt_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_node_pop_arr = 0;
  __Pyx_memviewslice __pyx_v_node_pop = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_sigma;
  double __pyx_v_gamma_a;
  double __pyx_v_gamma_y;
  double __pyx_v_gamma_h;
  double __pyx_v_eta;
  double __pyx_v_mu;
  double __pyx_v_tau;
  double __pyx_v_nu;
  double __pyx_v_pi;
  double __pyx_v_kappa;
  CYTHON_UNUSED double __pyx_v_report_rate;
  double __pyx_v_rho_a;
  double __pyx_v_rho_y;
  double __pyx_v_beta0_2;
  double __pyx_v_phi_1_2;
  CYTHON_UNUSED double __pyx_v_omega_e_2;
  double __pyx_v_omega_pa_2;
  double __pyx_v_omega_py_2;
  double __pyx_v_omega_a_2;
  double __pyx_v_omega_y_2;
  double __pyx_v_common_term;
  double __pyx_v_deterministic;
  double __pyx_v_S;
  double __pyx_v_E;
  double __pyx_v_Pa;
  double __pyx_v_Py;
  double __pyx_v_Ia;
  double __pyx_v_Iy;
  double __pyx_v_Ih;
  double __pyx_v_R;
  double __pyx_v_D;
  CYTHON_UNUSED double __pyx_v_E2P;
  CYTHON_UNUSED double __pyx_v_E2Py;
  CYTHON_UNUSED double __pyx_v_P2I;
  CYTHON_UNUSED double __pyx_v_Pa2Ia;
  CYTHON_UNUSED double __pyx_v_Py2Iy;
  CYTHON_UNUSED double __pyx_v_Iy2Ih;
  CYTHON_UNUSED double __pyx_v_H2D;
  double __pyx_v_Ia_2;
  double __pyx_v_Iy_2;
  double __pyx_v_Pa_2;
  double __pyx_v_Py_2;
  double __pyx_v_d_S;
  double __pyx_v_d_E;
  double __pyx_v_d_Pa;
  double __pyx_v_d_Py;
  double __pyx_v_d_Ia;
  double __pyx_v_d_Iy;
  double __pyx_v_d_Ih;
  double __pyx_v_d_R;
  double __pyx_v_d_D;
  double __pyx_v_new_S;
  double __pyx_v_new_E;
  double __pyx_v_new_Pa;
  double __pyx_v_new_Py;
  double __pyx_v_new_Ia;
  double __pyx_v_new_Iy;
  double __pyx_v_new_Ih;
  double __pyx_v_new_R;
  double __pyx_v_new_D;
  double __pyx_v_new_E2P;
  double __pyx_v_new_E2Py;
  double __pyx_v_new_P2I;
  double __pyx_v_new_Pa2Ia;
  double __pyx_v_new_Py2Iy;
  double __pyx_v_new_Iy2Ih;
  double __pyx_v_new_H2D;
  double __pyx_v_rate_S2E;
  double __pyx_v_rate_E2I;
  double __pyx_v_rate_E2P;
  double __pyx_v_rate_Pa2Ia;
  double __pyx_v_rate_Py2Iy;
  double __pyx_v_rate_Ia2R;
  double __pyx_v_rate_Iy2R;
  double __pyx_v_rate_Ih2R;
  double __pyx_v_rate_Iy2Ih;
  double __pyx_v_rate_Ih2D;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SEIR_intra_node", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("SEIRcity.model.cy_model.SEIR_intra_node", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_compt_counts);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_compt_v, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_node_pop_arr);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_node_pop, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">086</span>:                                 double [:, :] phi_v,</pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>:                                 double int_per_day,</pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>:                                 gsl_rng *rng):</pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:     cdef:</pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>:         # indexers and lengths of each dimension in state space</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>:         Py_ssize_t node_len = ntwk_v.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_node_len = (__pyx_v_ntwk_v.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>:         Py_ssize_t age_len = ntwk_v.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_age_len = (__pyx_v_ntwk_v.shape[1]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:         Py_ssize_t risk_len = ntwk_v.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_risk_len = (__pyx_v_ntwk_v.shape[2]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>:         Py_ssize_t vt_len = ntwk_v.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_vt_len = (__pyx_v_ntwk_v.shape[3]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>:         Py_ssize_t compt_len = ntwk_v.shape[4]</pre>
<pre class='cython code score-0 '>  __pyx_v_compt_len = (__pyx_v_ntwk_v.shape[4]);
</pre><pre class="cython line score-0">&#xA0;<span class="">098</span>:         Py_ssize_t n, a, r, a_2, r_2</pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>:         # output state array. Note that the only 'value_type' we are about</pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>:         # is index 0, or 'count'</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>:         np.ndarray compt_counts = np.nan * np.empty(</pre>
<pre class='cython code score-30 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_nan);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7);
  __pyx_t_7 = 0;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>
  __pyx_v_compt_counts = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>:             (node_len, age_len, risk_len, compt_len), dtype=DTYPE_FLOAT)</pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_node_len);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_age_len);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_risk_len);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_compt_len);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_t_6);
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
/* … */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE_FLOAT);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>:         double [:, :, :, :] compt_v = compt_counts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double</span>(((PyObject *)__pyx_v_compt_counts), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  __pyx_v_compt_v = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">105</span>:         # node population is the sum of all compartments for a given time,</pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>:         # node, and age group</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>:         np.ndarray node_pop_arr = np.sum(ntwk_v[:, :, :, 0, :], axis=(2, -1))</pre>
<pre class='cython code score-30 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8.data = __pyx_v_ntwk_v.data;
  __pyx_t_8.memview = __pyx_v_ntwk_v.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 0);
  __pyx_t_8.shape[0] = __pyx_v_ntwk_v.shape[0];
__pyx_t_8.strides[0] = __pyx_v_ntwk_v.strides[0];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_t_8.shape[1] = __pyx_v_ntwk_v.shape[1];
__pyx_t_8.strides[1] = __pyx_v_ntwk_v.strides[1];
    __pyx_t_8.suboffsets[1] = -1;

__pyx_t_8.shape[2] = __pyx_v_ntwk_v.shape[2];
__pyx_t_8.strides[2] = __pyx_v_ntwk_v.strides[2];
    __pyx_t_8.suboffsets[2] = -1;

{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_ntwk_v.strides[3];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[3] = __pyx_v_ntwk_v.shape[4];
__pyx_t_8.strides[3] = __pyx_v_ntwk_v.strides[4];
    __pyx_t_8.suboffsets[3] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_8, 4, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_axis, __pyx_tuple_) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
  __pyx_v_node_pop_arr = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>:         double [:, :] node_pop = node_pop_arr</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(((PyObject *)__pyx_v_node_pop_arr), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  __pyx_v_node_pop = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">109</span>:         # epi params</pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>:         double beta0, sigma, gamma_a, gamma_y, gamma_h, eta, mu, tau, nu, pi, \</pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>:             kappa, report_rate, rho_a, rho_y</pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>:         # epi params for force of infection calculation</pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>:         double beta0_2, phi_1_2, omega_e_2, omega_pa_2, omega_py_2, omega_a_2, \</pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>:             omega_y_2, common_term, deterministic</pre>
<pre class="cython line score-0">&#xA0;<span class="">115</span>:         # compartment counts</pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>:         double S, E, Pa, Py, Ia, Iy, Ih, R, D, E2P, E2Py, P2I, Pa2Ia, Py2Iy, \</pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>:             Iy2Ih, H2D</pre>
<pre class="cython line score-0">&#xA0;<span class="">118</span>:         # compartment counts for force of infection calculation</pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>:         double E_2, Ia_2, Iy_2, Pa_2, Py_2</pre>
<pre class="cython line score-0">&#xA0;<span class="">120</span>:         # delta compartment values</pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>:         double d_S, d_E, d_Pa, d_Py, d_Ia, d_Iy, d_Ih, d_R, d_D</pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>:         # new compartment values, after deltas applied</pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>:         double new_S, new_E, new_Pa, new_Py, new_Ia, new_Iy, new_Ih, new_R, \</pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>:             new_D, new_E2P, new_E2Py, new_P2I, new_Pa2Ia, new_Py2Iy, \</pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:             new_Iy2Ih, new_H2D</pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>:         # rates between compartments</pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>:         double rate_S2E, rate_E2I, rate_E2P, rate_Pa2Ia, rate_Py2Iy, rate_Ia2R, \</pre>
<pre class="cython line score-0">&#xA0;<span class="">128</span>:             rate_Iy2R, rate_Ih2R, rate_Iy2Ih, rate_Ih2D,</pre>
<pre class="cython line score-0">&#xA0;<span class="">129</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>:     # Iterate over node, age, and risk</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:     for n in prange(node_len, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_10 = __pyx_v_node_len;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_12 = (__pyx_t_10 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_12 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_D) lastprivate(__pyx_v_E) lastprivate(__pyx_v_E2P) lastprivate(__pyx_v_E2Py) lastprivate(__pyx_v_H2D) lastprivate(__pyx_v_Ia) lastprivate(__pyx_v_Ia_2) lastprivate(__pyx_v_Ih) lastprivate(__pyx_v_Iy) lastprivate(__pyx_v_Iy2Ih) lastprivate(__pyx_v_Iy_2) lastprivate(__pyx_v_P2I) lastprivate(__pyx_v_Pa) lastprivate(__pyx_v_Pa2Ia) lastprivate(__pyx_v_Pa_2) lastprivate(__pyx_v_Py) lastprivate(__pyx_v_Py2Iy) lastprivate(__pyx_v_Py_2) lastprivate(__pyx_v_R) lastprivate(__pyx_v_S) lastprivate(__pyx_v_a) lastprivate(__pyx_v_a_2) lastprivate(__pyx_v_beta0_2) lastprivate(__pyx_v_common_term) lastprivate(__pyx_v_d_D) lastprivate(__pyx_v_d_E) lastprivate(__pyx_v_d_Ia) lastprivate(__pyx_v_d_Ih) lastprivate(__pyx_v_d_Iy) lastprivate(__pyx_v_d_Pa) lastprivate(__pyx_v_d_Py) lastprivate(__pyx_v_d_R) lastprivate(__pyx_v_d_S) lastprivate(__pyx_v_deterministic) lastprivate(__pyx_v_eta) lastprivate(__pyx_v_gamma_a) lastprivate(__pyx_v_gamma_h) lastprivate(__pyx_v_gamma_y) lastprivate(__pyx_v_kappa) lastprivate(__pyx_v_mu) firstprivate(__pyx_v_n) lastprivate(__pyx_v_n) lastprivate(__pyx_v_new_D) lastprivate(__pyx_v_new_E) lastprivate(__pyx_v_new_E2P) lastprivate(__pyx_v_new_E2Py) lastprivate(__pyx_v_new_H2D) lastprivate(__pyx_v_new_Ia) lastprivate(__pyx_v_new_Ih) lastprivate(__pyx_v_new_Iy) lastprivate(__pyx_v_new_Iy2Ih) lastprivate(__pyx_v_new_P2I) lastprivate(__pyx_v_new_Pa) lastprivate(__pyx_v_new_Pa2Ia) lastprivate(__pyx_v_new_Py) lastprivate(__pyx_v_new_Py2Iy) lastprivate(__pyx_v_new_R) lastprivate(__pyx_v_new_S) lastprivate(__pyx_v_nu) lastprivate(__pyx_v_omega_a_2) lastprivate(__pyx_v_omega_e_2) lastprivate(__pyx_v_omega_pa_2) lastprivate(__pyx_v_omega_py_2) lastprivate(__pyx_v_omega_y_2) lastprivate(__pyx_v_phi_1_2) lastprivate(__pyx_v_pi) lastprivate(__pyx_v_r) lastprivate(__pyx_v_r_2) lastprivate(__pyx_v_rate_E2I) lastprivate(__pyx_v_rate_E2P) lastprivate(__pyx_v_rate_Ia2R) lastprivate(__pyx_v_rate_Ih2D) lastprivate(__pyx_v_rate_Ih2R) lastprivate(__pyx_v_rate_Iy2Ih) lastprivate(__pyx_v_rate_Iy2R) lastprivate(__pyx_v_rate_Pa2Ia) lastprivate(__pyx_v_rate_Py2Iy) lastprivate(__pyx_v_rate_S2E) lastprivate(__pyx_v_report_rate) lastprivate(__pyx_v_rho_a) lastprivate(__pyx_v_rho_y) lastprivate(__pyx_v_sigma) lastprivate(__pyx_v_tau)
                    #endif /* _OPENMP */
                    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_12; __pyx_t_11++){
                        {
                            __pyx_v_n = (Py_ssize_t)(0 + 1 * __pyx_t_11);
                            /* Initialize private variables to invalid values */
                            __pyx_v_D = ((double)__PYX_NAN());
                            __pyx_v_E = ((double)__PYX_NAN());
                            __pyx_v_E2P = ((double)__PYX_NAN());
                            __pyx_v_E2Py = ((double)__PYX_NAN());
                            __pyx_v_H2D = ((double)__PYX_NAN());
                            __pyx_v_Ia = ((double)__PYX_NAN());
                            __pyx_v_Ia_2 = ((double)__PYX_NAN());
                            __pyx_v_Ih = ((double)__PYX_NAN());
                            __pyx_v_Iy = ((double)__PYX_NAN());
                            __pyx_v_Iy2Ih = ((double)__PYX_NAN());
                            __pyx_v_Iy_2 = ((double)__PYX_NAN());
                            __pyx_v_P2I = ((double)__PYX_NAN());
                            __pyx_v_Pa = ((double)__PYX_NAN());
                            __pyx_v_Pa2Ia = ((double)__PYX_NAN());
                            __pyx_v_Pa_2 = ((double)__PYX_NAN());
                            __pyx_v_Py = ((double)__PYX_NAN());
                            __pyx_v_Py2Iy = ((double)__PYX_NAN());
                            __pyx_v_Py_2 = ((double)__PYX_NAN());
                            __pyx_v_R = ((double)__PYX_NAN());
                            __pyx_v_S = ((double)__PYX_NAN());
                            __pyx_v_a = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_a_2 = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_beta0_2 = ((double)__PYX_NAN());
                            __pyx_v_common_term = ((double)__PYX_NAN());
                            __pyx_v_d_D = ((double)__PYX_NAN());
                            __pyx_v_d_E = ((double)__PYX_NAN());
                            __pyx_v_d_Ia = ((double)__PYX_NAN());
                            __pyx_v_d_Ih = ((double)__PYX_NAN());
                            __pyx_v_d_Iy = ((double)__PYX_NAN());
                            __pyx_v_d_Pa = ((double)__PYX_NAN());
                            __pyx_v_d_Py = ((double)__PYX_NAN());
                            __pyx_v_d_R = ((double)__PYX_NAN());
                            __pyx_v_d_S = ((double)__PYX_NAN());
                            __pyx_v_deterministic = ((double)__PYX_NAN());
                            __pyx_v_eta = ((double)__PYX_NAN());
                            __pyx_v_gamma_a = ((double)__PYX_NAN());
                            __pyx_v_gamma_h = ((double)__PYX_NAN());
                            __pyx_v_gamma_y = ((double)__PYX_NAN());
                            __pyx_v_kappa = ((double)__PYX_NAN());
                            __pyx_v_mu = ((double)__PYX_NAN());
                            __pyx_v_new_D = ((double)__PYX_NAN());
                            __pyx_v_new_E = ((double)__PYX_NAN());
                            __pyx_v_new_E2P = ((double)__PYX_NAN());
                            __pyx_v_new_E2Py = ((double)__PYX_NAN());
                            __pyx_v_new_H2D = ((double)__PYX_NAN());
                            __pyx_v_new_Ia = ((double)__PYX_NAN());
                            __pyx_v_new_Ih = ((double)__PYX_NAN());
                            __pyx_v_new_Iy = ((double)__PYX_NAN());
                            __pyx_v_new_Iy2Ih = ((double)__PYX_NAN());
                            __pyx_v_new_P2I = ((double)__PYX_NAN());
                            __pyx_v_new_Pa = ((double)__PYX_NAN());
                            __pyx_v_new_Pa2Ia = ((double)__PYX_NAN());
                            __pyx_v_new_Py = ((double)__PYX_NAN());
                            __pyx_v_new_Py2Iy = ((double)__PYX_NAN());
                            __pyx_v_new_R = ((double)__PYX_NAN());
                            __pyx_v_new_S = ((double)__PYX_NAN());
                            __pyx_v_nu = ((double)__PYX_NAN());
                            __pyx_v_omega_a_2 = ((double)__PYX_NAN());
                            __pyx_v_omega_e_2 = ((double)__PYX_NAN());
                            __pyx_v_omega_pa_2 = ((double)__PYX_NAN());
                            __pyx_v_omega_py_2 = ((double)__PYX_NAN());
                            __pyx_v_omega_y_2 = ((double)__PYX_NAN());
                            __pyx_v_phi_1_2 = ((double)__PYX_NAN());
                            __pyx_v_pi = ((double)__PYX_NAN());
                            __pyx_v_r = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_r_2 = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_rate_E2I = ((double)__PYX_NAN());
                            __pyx_v_rate_E2P = ((double)__PYX_NAN());
                            __pyx_v_rate_Ia2R = ((double)__PYX_NAN());
                            __pyx_v_rate_Ih2D = ((double)__PYX_NAN());
                            __pyx_v_rate_Ih2R = ((double)__PYX_NAN());
                            __pyx_v_rate_Iy2Ih = ((double)__PYX_NAN());
                            __pyx_v_rate_Iy2R = ((double)__PYX_NAN());
                            __pyx_v_rate_Pa2Ia = ((double)__PYX_NAN());
                            __pyx_v_rate_Py2Iy = ((double)__PYX_NAN());
                            __pyx_v_rate_S2E = ((double)__PYX_NAN());
                            __pyx_v_report_rate = ((double)__PYX_NAN());
                            __pyx_v_rho_a = ((double)__PYX_NAN());
                            __pyx_v_rho_y = ((double)__PYX_NAN());
                            __pyx_v_sigma = ((double)__PYX_NAN());
                            __pyx_v_tau = ((double)__PYX_NAN());
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">132</span>:     # for n in range(node_len):</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:         for a in range(age_len):</pre>
<pre class='cython code score-0 '>                            __pyx_t_13 = __pyx_v_age_len;
                            __pyx_t_14 = __pyx_t_13;
                            for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
                              __pyx_v_a = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:             for r in range(risk_len):</pre>
<pre class='cython code score-0 '>                              __pyx_t_16 = __pyx_v_risk_len;
                              __pyx_t_17 = __pyx_t_16;
                              for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
                                __pyx_v_r = __pyx_t_18;
</pre><pre class="cython line score-0">&#xA0;<span class="">135</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">136</span>:                 # --------------   Expand epi parameters  --------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>:                 # 'count', 'beta0', 'sigma', 'gamma', 'eta', 'mu', 'omega', 'tau', 'nu', 'pi', 'kappa', 'report_rate', 'rho'</pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>:                 # WARNING: index on 0 at compartments</pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>:                 # dimension assumes that epi param</pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>:                 # is same for all compartments</pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>:                 # beta0 = ntwk_v[n, a, r, 1, 0]</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:                 sigma = discrete_time_approx(ntwk_v[n, a, r, 2, 0], int_per_day)</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 2;
                                __pyx_t_23 = 0;
                                __pyx_v_sigma = __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) ))), __pyx_v_int_per_day);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:                 gamma_a = discrete_time_approx(ntwk_v[n, a, r, 3, 4], int_per_day)</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 3;
                                __pyx_t_19 = 4;
                                __pyx_v_gamma_a = __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) ))), __pyx_v_int_per_day);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:                 gamma_y = discrete_time_approx(ntwk_v[n, a, r, 3, 5], int_per_day)</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 3;
                                __pyx_t_23 = 5;
                                __pyx_v_gamma_y = __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) ))), __pyx_v_int_per_day);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:                 gamma_h = discrete_time_approx(ntwk_v[n, a, r, 3, 6], int_per_day)</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 3;
                                __pyx_t_19 = 6;
                                __pyx_v_gamma_h = __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) ))), __pyx_v_int_per_day);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:                 eta = discrete_time_approx(ntwk_v[n, a, r, 4, 0], int_per_day)</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 4;
                                __pyx_t_23 = 0;
                                __pyx_v_eta = __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) ))), __pyx_v_int_per_day);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:                 mu = discrete_time_approx(ntwk_v[n, a, r, 5, 0], int_per_day)</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 5;
                                __pyx_t_19 = 0;
                                __pyx_v_mu = __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) ))), __pyx_v_int_per_day);
</pre><pre class="cython line score-0">&#xA0;<span class="">149</span>:                 # omega = ntwk_v[n, a, r, 6, 0]</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:                 tau = ntwk_v[n, a, r, 7, 0]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 7;
                                __pyx_t_23 = 0;
                                __pyx_v_tau = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:                 nu = ntwk_v[n, a, r, 8, 0]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 8;
                                __pyx_t_19 = 0;
                                __pyx_v_nu = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:                 pi = ntwk_v[n, a, r, 9, 0]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 9;
                                __pyx_t_23 = 0;
                                __pyx_v_pi = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:                 kappa = ntwk_v[n, a, r, 10, 0]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 10;
                                __pyx_t_19 = 0;
                                __pyx_v_kappa = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:                 report_rate = ntwk_v[n, a, r, 11, 0]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 11;
                                __pyx_t_23 = 0;
                                __pyx_v_report_rate = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:                 rho_a = discrete_time_approx(ntwk_v[n, a, r, 12, 4], int_per_day)</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 12;
                                __pyx_t_19 = 4;
                                __pyx_v_rho_a = __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) ))), __pyx_v_int_per_day);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:                 rho_y = discrete_time_approx(ntwk_v[n, a, r, 12, 5], int_per_day)</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 12;
                                __pyx_t_23 = 5;
                                __pyx_v_rho_y = __pyx_f_8SEIRcity_5model_8cy_model_discrete_time_approx((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) ))), __pyx_v_int_per_day);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:                 deterministic = ntwk_v[n, a, r, 13, 0]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 13;
                                __pyx_t_19 = 0;
                                __pyx_v_deterministic = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>:                 # -----------   Expand compartment counts  -------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>:                 # 'S', 'E', 'Pa', 'Py', 'Ia', 'Iy', 'Ih', 'R', 'D', 'E2P', 'E2Py', 'P2I', 'Pa2Ia', 'Py2Iy', 'Iy2Ih', 'H2D'</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:                 S = ntwk_v[n, a, r, 0, 0]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 0;
                                __pyx_t_23 = 0;
                                __pyx_v_S = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:                 E = ntwk_v[n, a, r, 0, 1]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 0;
                                __pyx_t_19 = 1;
                                __pyx_v_E = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:                 Pa = ntwk_v[n, a, r, 0, 2]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 0;
                                __pyx_t_23 = 2;
                                __pyx_v_Pa = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>:                 Py = ntwk_v[n, a, r, 0, 3]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 0;
                                __pyx_t_19 = 3;
                                __pyx_v_Py = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:                 Ia = ntwk_v[n, a, r, 0, 4]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 0;
                                __pyx_t_23 = 4;
                                __pyx_v_Ia = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">167</span>:                 Iy = ntwk_v[n, a, r, 0, 5]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 0;
                                __pyx_t_19 = 5;
                                __pyx_v_Iy = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>:                 Ih = ntwk_v[n, a, r, 0, 6]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 0;
                                __pyx_t_23 = 6;
                                __pyx_v_Ih = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:                 R = ntwk_v[n, a, r, 0, 7]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 0;
                                __pyx_t_19 = 7;
                                __pyx_v_R = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:                 D = ntwk_v[n, a, r, 0, 8]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 0;
                                __pyx_t_23 = 8;
                                __pyx_v_D = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:                 E2P = ntwk_v[n, a, r, 0, 9]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 0;
                                __pyx_t_19 = 9;
                                __pyx_v_E2P = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:                 E2Py = ntwk_v[n, a, r, 0, 10]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 0;
                                __pyx_t_23 = 10;
                                __pyx_v_E2Py = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:                 P2I = ntwk_v[n, a, r, 0, 11]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 0;
                                __pyx_t_19 = 11;
                                __pyx_v_P2I = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>:                 Pa2Ia = ntwk_v[n, a, r, 0, 12]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 0;
                                __pyx_t_23 = 12;
                                __pyx_v_Pa2Ia = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:                 Py2Iy = ntwk_v[n, a, r, 0, 13]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 0;
                                __pyx_t_19 = 13;
                                __pyx_v_Py2Iy = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:                 Iy2Ih = ntwk_v[n, a, r, 0, 14]</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_22 = 0;
                                __pyx_t_23 = 14;
                                __pyx_v_Iy2Ih = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:                 H2D = ntwk_v[n, a, r, 0, 15]</pre>
<pre class='cython code score-0 '>                                __pyx_t_23 = __pyx_v_n;
                                __pyx_t_22 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_20 = 0;
                                __pyx_t_19 = 15;
                                __pyx_v_H2D = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_23 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">179</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>:                 # -----------   Calculate force of infection  ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:                 rate_S2E = 0.</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_S2E = 0.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>:                 for a_2 in range(age_len):</pre>
<pre class='cython code score-0 '>                                __pyx_t_24 = __pyx_v_age_len;
                                __pyx_t_25 = __pyx_t_24;
                                for (__pyx_t_26 = 0; __pyx_t_26 &lt; __pyx_t_25; __pyx_t_26+=1) {
                                  __pyx_v_a_2 = __pyx_t_26;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:                     for r_2 in range(risk_len):</pre>
<pre class='cython code score-0 '>                                  __pyx_t_27 = __pyx_v_risk_len;
                                  __pyx_t_28 = __pyx_t_27;
                                  for (__pyx_t_29 = 0; __pyx_t_29 &lt; __pyx_t_28; __pyx_t_29+=1) {
                                    __pyx_v_r_2 = __pyx_t_29;
</pre><pre class="cython line score-0">&#xA0;<span class="">185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>:                         # Get age/compartment stratified params for a_2, r_2</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>:                         beta0_2 = ntwk_v[n, a_2, r_2, 1, 0]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_19 = __pyx_v_n;
                                    __pyx_t_20 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_22 = 1;
                                    __pyx_t_23 = 0;
                                    __pyx_v_beta0_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:                         phi_1_2 = phi_v[a, a_2]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_23 = __pyx_v_a;
                                    __pyx_t_22 = __pyx_v_a_2;
                                    __pyx_v_phi_1_2 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_phi_v.data + __pyx_t_23 * __pyx_v_phi_v.strides[0]) ) + __pyx_t_22 * __pyx_v_phi_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:                         omega_e_2 = ntwk_v[n, a_2, r_2, 6, 1]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_22 = __pyx_v_n;
                                    __pyx_t_23 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_20 = 6;
                                    __pyx_t_19 = 1;
                                    __pyx_v_omega_e_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_22 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:                         omega_pa_2 = ntwk_v[n, a_2, r_2, 6, 2]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_19 = __pyx_v_n;
                                    __pyx_t_20 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_23 = 6;
                                    __pyx_t_22 = 2;
                                    __pyx_v_omega_pa_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">191</span>:                         omega_py_2 = ntwk_v[n, a_2, r_2, 6, 3]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_22 = __pyx_v_n;
                                    __pyx_t_23 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_20 = 6;
                                    __pyx_t_19 = 3;
                                    __pyx_v_omega_py_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_22 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">192</span>:                         omega_a_2 = ntwk_v[n, a_2, r_2, 6, 4]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_19 = __pyx_v_n;
                                    __pyx_t_20 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_23 = 6;
                                    __pyx_t_22 = 4;
                                    __pyx_v_omega_a_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>:                         omega_y_2 = ntwk_v[n, a_2, r_2, 6, 5]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_22 = __pyx_v_n;
                                    __pyx_t_23 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_20 = 6;
                                    __pyx_t_19 = 5;
                                    __pyx_v_omega_y_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_22 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">194</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>:                         # get compartments for a_2, r_2</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:                         Pa_2 = ntwk_v[n, a_2, r_2, 0, 2]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_19 = __pyx_v_n;
                                    __pyx_t_20 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_23 = 0;
                                    __pyx_t_22 = 2;
                                    __pyx_v_Pa_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>:                         Py_2 = ntwk_v[n, a_2, r_2, 0, 3]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_22 = __pyx_v_n;
                                    __pyx_t_23 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_20 = 0;
                                    __pyx_t_19 = 3;
                                    __pyx_v_Py_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_22 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:                         Ia_2 = ntwk_v[n, a_2, r_2, 0, 4]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_19 = __pyx_v_n;
                                    __pyx_t_20 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_23 = 0;
                                    __pyx_t_22 = 4;
                                    __pyx_v_Ia_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_19 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_22 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:                         Iy_2 = ntwk_v[n, a_2, r_2, 0, 5]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_22 = __pyx_v_n;
                                    __pyx_t_23 = __pyx_v_a_2;
                                    __pyx_t_21 = __pyx_v_r_2;
                                    __pyx_t_20 = 0;
                                    __pyx_t_19 = 5;
                                    __pyx_v_Iy_2 = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_22 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_23 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_21 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_20 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_19 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">200</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>:                         # Ignore case where node population is zero or negative</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:                         if node_pop[n, a_2] &lt;= 0:</pre>
<pre class='cython code score-0 '>                                    __pyx_t_19 = __pyx_v_n;
                                    __pyx_t_20 = __pyx_v_a_2;
                                    __pyx_t_30 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_node_pop.data + __pyx_t_19 * __pyx_v_node_pop.strides[0]) ) + __pyx_t_20 * __pyx_v_node_pop.strides[1]) ))) &lt;= 0.0) != 0);
                                    if (__pyx_t_30) {
/* … */
                                    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:                             continue</pre>
<pre class='cython code score-0 '>                                      goto __pyx_L16_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">205</span>:                         # calculate force of infection</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:                         common_term = beta0_2 * kappa * phi_1_2 * S / node_pop[n, a_2]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_20 = __pyx_v_n;
                                    __pyx_t_19 = __pyx_v_a_2;
                                    __pyx_v_common_term = ((((__pyx_v_beta0_2 * __pyx_v_kappa) * __pyx_v_phi_1_2) * __pyx_v_S) / (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_node_pop.data + __pyx_t_20 * __pyx_v_node_pop.strides[0]) ) + __pyx_t_19 * __pyx_v_node_pop.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:                         rate_S2E = rate_S2E + (common_term * (</pre>
<pre class='cython code score-0 '>                                    __pyx_v_rate_S2E = (__pyx_v_rate_S2E + (__pyx_v_common_term * ((((__pyx_v_omega_a_2 * __pyx_v_Ia_2) + (__pyx_v_omega_y_2 * __pyx_v_Iy_2)) + (__pyx_v_omega_pa_2 * __pyx_v_Pa_2)) + (__pyx_v_omega_py_2 * __pyx_v_Py_2))));
                                    __pyx_L16_continue:;
                                  }
                                }
</pre><pre class="cython line score-0">&#xA0;<span class="">208</span>:                             (omega_a_2 * Ia_2) + \</pre>
<pre class="cython line score-0">&#xA0;<span class="">209</span>:                             (omega_y_2 * Iy_2) + \</pre>
<pre class="cython line score-0">&#xA0;<span class="">210</span>:                             (omega_pa_2 * Pa_2) + \</pre>
<pre class="cython line score-0">&#xA0;<span class="">211</span>:                             (omega_py_2 * Py_2)))</pre>
<pre class="cython line score-0">&#xA0;<span class="">212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">213</span>:                 # ----------------   Get other deltas  -----------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">214</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:                 rate_E2P = sigma * E</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_E2P = (__pyx_v_sigma * __pyx_v_E);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:                 rate_Pa2Ia = rho_a * Pa</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_Pa2Ia = (__pyx_v_rho_a * __pyx_v_Pa);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:                 rate_Py2Iy = rho_y * Py</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_Py2Iy = (__pyx_v_rho_y * __pyx_v_Py);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:                 rate_Ia2R = gamma_a * Ia</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_Ia2R = (__pyx_v_gamma_a * __pyx_v_Ia);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:                 rate_Iy2R = (1 - pi) * gamma_y * Iy</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_Iy2R = (((1.0 - __pyx_v_pi) * __pyx_v_gamma_y) * __pyx_v_Iy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:                 rate_Ih2R = (1 - nu) * gamma_h * Ih</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_Ih2R = (((1.0 - __pyx_v_nu) * __pyx_v_gamma_h) * __pyx_v_Ih);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:                 rate_Iy2Ih = pi * eta * Iy</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_Iy2Ih = ((__pyx_v_pi * __pyx_v_eta) * __pyx_v_Iy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:                 rate_Ih2D = nu * mu * Ih</pre>
<pre class='cython code score-0 '>                                __pyx_v_rate_Ih2D = ((__pyx_v_nu * __pyx_v_mu) * __pyx_v_Ih);
</pre><pre class="cython line score-0">&#xA0;<span class="">223</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">224</span>:                 # --------------   Sample from Poisson  ----------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">225</span>:                 # For `deterministic` == 0 only</pre>
<pre class="cython line score-0">&#xA0;<span class="">226</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:                 if deterministic == 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_deterministic == 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:                     rate_S2E = gsl_ran_poisson(rng, rate_S2E)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_S2E = gsl_ran_poisson(__pyx_v_rng, __pyx_v_rate_S2E);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:                     rate_E2I = gsl_ran_poisson(rng, rate_E2I)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_E2I = gsl_ran_poisson(__pyx_v_rng, __pyx_v_rate_E2I);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:                     rate_Ia2R = gsl_ran_poisson(rng, rate_Ia2R)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ia2R = gsl_ran_poisson(__pyx_v_rng, __pyx_v_rate_Ia2R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:                     rate_Iy2R = gsl_ran_poisson(rng, rate_Iy2R)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Iy2R = gsl_ran_poisson(__pyx_v_rng, __pyx_v_rate_Iy2R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:                     rate_Ih2R = gsl_ran_poisson(rng, rate_Ih2R)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ih2R = gsl_ran_poisson(__pyx_v_rng, __pyx_v_rate_Ih2R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:                     rate_Iy2Ih = gsl_ran_poisson(rng, rate_Iy2Ih)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Iy2Ih = gsl_ran_poisson(__pyx_v_rng, __pyx_v_rate_Iy2Ih);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:                     rate_Ih2D = gsl_ran_poisson(rng, rate_Ih2D)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ih2D = gsl_ran_poisson(__pyx_v_rng, __pyx_v_rate_Ih2D);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:                 if isinf(rate_S2E):</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = (isinf(__pyx_v_rate_S2E) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:                     rate_S2E = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_S2E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:                 if isinf(rate_E2I):</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = (isinf(__pyx_v_rate_E2I) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:                     rate_E2I = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_E2I = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:                 if isinf(rate_Ia2R):</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = (isinf(__pyx_v_rate_Ia2R) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:                     rate_Ia2R = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ia2R = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:                 if isinf(rate_Iy2R):</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = (isinf(__pyx_v_rate_Iy2R) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:                     rate_Iy2R = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Iy2R = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:                 if isinf(rate_Ih2R):</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = (isinf(__pyx_v_rate_Ih2R) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:                     rate_Ih2R = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ih2R = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:                 if isinf(rate_Iy2Ih):</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = (isinf(__pyx_v_rate_Iy2Ih) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:                     rate_Iy2Ih = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Iy2Ih = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:                 if isinf(rate_Ih2D):</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = (isinf(__pyx_v_rate_Ih2D) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>:                     rate_Ih2D = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ih2D = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">249</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>:                 # -----------------   Apply deltas  --------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:                 d_S = -rate_S2E</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_S = (-__pyx_v_rate_S2E);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:                 new_S = S + d_S</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_S = (__pyx_v_S + __pyx_v_d_S);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:                 if new_S &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_S &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:                     rate_S2E = S</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_S2E = __pyx_v_S;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:                     rate_S2E = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_S2E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">257</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">258</span>:                 d_E = rate_S2E - rate_E2P</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_E = (__pyx_v_rate_S2E - __pyx_v_rate_E2P);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:                 new_E = E + d_E</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_E = (__pyx_v_E + __pyx_v_d_E);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:                 if new_E &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_E &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:                     rate_E2P = E + rate_S2E</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_E2P = (__pyx_v_E + __pyx_v_rate_S2E);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:                     new_E = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">263</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:                 new_E2P = rate_E2P</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_E2P = __pyx_v_rate_E2P;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:                 new_E2Py = tau * rate_E2P</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_E2Py = (__pyx_v_tau * __pyx_v_rate_E2P);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:                 if new_E2Py &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_E2Py &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:                     rate_E2P = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_E2P = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:                     new_E2P = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_E2P = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:                     new_E2Py = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_E2Py = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">270</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:                 d_Pa = (1 - tau) * rate_E2P - rate_Pa2Ia</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_Pa = (((1.0 - __pyx_v_tau) * __pyx_v_rate_E2P) - __pyx_v_rate_Pa2Ia);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:                 new_Pa = Pa + d_Pa</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_Pa = (__pyx_v_Pa + __pyx_v_d_Pa);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:                 new_Pa2Ia = rate_Pa2Ia</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_Pa2Ia = __pyx_v_rate_Pa2Ia;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:                 if new_Pa &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_Pa &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:                     rate_Pa2Ia = Pa + (1 - tau) * rate_E2P</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Pa2Ia = (__pyx_v_Pa + ((1.0 - __pyx_v_tau) * __pyx_v_rate_E2P));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:                     new_Pa = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_Pa = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:                     new_Pa2Ia = rate_Pa2Ia</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_Pa2Ia = __pyx_v_rate_Pa2Ia;
</pre><pre class="cython line score-0">&#xA0;<span class="">278</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:                 d_Py = tau * rate_E2P - rate_Py2Iy</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_Py = ((__pyx_v_tau * __pyx_v_rate_E2P) - __pyx_v_rate_Py2Iy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:                 new_Py = Py + d_Py</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_Py = (__pyx_v_Py + __pyx_v_d_Py);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:                 new_Py2Iy = rate_Py2Iy</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_Py2Iy = __pyx_v_rate_Py2Iy;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:                 if new_Py &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_Py &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:                     rate_Py2Iy = Py + tau * rate_E2P</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Py2Iy = (__pyx_v_Py + (__pyx_v_tau * __pyx_v_rate_E2P));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:                     new_Py = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_Py = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:                     new_Py2Iy = rate_Py2Iy</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_Py2Iy = __pyx_v_rate_Py2Iy;
</pre><pre class="cython line score-0">&#xA0;<span class="">286</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>:                 new_P2I = new_Pa2Ia + new_Py2Iy</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_P2I = (__pyx_v_new_Pa2Ia + __pyx_v_new_Py2Iy);
</pre><pre class="cython line score-0">&#xA0;<span class="">288</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:                 d_Ia = rate_Pa2Ia - rate_Ia2R</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_Ia = (__pyx_v_rate_Pa2Ia - __pyx_v_rate_Ia2R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:                 new_Ia = Ia + d_Ia</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_Ia = (__pyx_v_Ia + __pyx_v_d_Ia);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:                 if new_Ia &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_Ia &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:                     rate_Ia2R = Ia + rate_Pa2Ia</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ia2R = (__pyx_v_Ia + __pyx_v_rate_Pa2Ia);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:                     new_Ia = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_Ia = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">294</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:                 d_Iy = rate_Py2Iy - rate_Iy2R - rate_Iy2Ih</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_Iy = ((__pyx_v_rate_Py2Iy - __pyx_v_rate_Iy2R) - __pyx_v_rate_Iy2Ih);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:                 new_Iy = Iy + d_Iy</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_Iy = (__pyx_v_Iy + __pyx_v_d_Iy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:                 if new_Iy &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_Iy &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:                     rate_Iy2R = (Iy + rate_Py2Iy) * rate_Iy2R / (rate_Iy2R + rate_Iy2Ih)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Iy2R = (((__pyx_v_Iy + __pyx_v_rate_Py2Iy) * __pyx_v_rate_Iy2R) / (__pyx_v_rate_Iy2R + __pyx_v_rate_Iy2Ih));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:                     rate_Iy2Ih = Iy + rate_Py2Iy - rate_Iy2R</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Iy2Ih = ((__pyx_v_Iy + __pyx_v_rate_Py2Iy) - __pyx_v_rate_Iy2R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:                     new_Iy = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_Iy = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">301</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">302</span>:                 new_Iy2Ih = rate_Iy2Ih</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_Iy2Ih = __pyx_v_rate_Iy2Ih;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">303</span>:                 if new_Iy2Ih &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_Iy2Ih &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">304</span>:                     new_Iy2Ih = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_Iy2Ih = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">305</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>:                 d_Ih = rate_Iy2Ih - rate_Ih2R - rate_Ih2D</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_Ih = ((__pyx_v_rate_Iy2Ih - __pyx_v_rate_Ih2R) - __pyx_v_rate_Ih2D);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:                 new_Ih = Ih + d_Ih</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_Ih = (__pyx_v_Ih + __pyx_v_d_Ih);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:                 if new_Ih &lt; 0:</pre>
<pre class='cython code score-0 '>                                __pyx_t_30 = ((__pyx_v_new_Ih &lt; 0.0) != 0);
                                if (__pyx_t_30) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:                     rate_Ih2R = (Ih + rate_Iy2Ih) * rate_Ih2R / (rate_Ih2R + rate_Ih2D)</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ih2R = (((__pyx_v_Ih + __pyx_v_rate_Iy2Ih) * __pyx_v_rate_Ih2R) / (__pyx_v_rate_Ih2R + __pyx_v_rate_Ih2D));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">310</span>:                     rate_Ih2D = Ih + rate_Iy2Ih - rate_Ih2R</pre>
<pre class='cython code score-0 '>                                  __pyx_v_rate_Ih2D = ((__pyx_v_Ih + __pyx_v_rate_Iy2Ih) - __pyx_v_rate_Ih2R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:                     new_Ih = 0</pre>
<pre class='cython code score-0 '>                                  __pyx_v_new_Ih = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">312</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:                 d_R = rate_Ia2R + rate_Iy2R + rate_Ih2R</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_R = ((__pyx_v_rate_Ia2R + __pyx_v_rate_Iy2R) + __pyx_v_rate_Ih2R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:                 new_R = R + d_R</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_R = (__pyx_v_R + __pyx_v_d_R);
</pre><pre class="cython line score-0">&#xA0;<span class="">315</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:                 d_D = rate_Ih2D</pre>
<pre class='cython code score-0 '>                                __pyx_v_d_D = __pyx_v_rate_Ih2D;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:                 new_H2D = rate_Ih2D</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_H2D = __pyx_v_rate_Ih2D;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:                 new_D = D + d_D</pre>
<pre class='cython code score-0 '>                                __pyx_v_new_D = (__pyx_v_D + __pyx_v_d_D);
</pre><pre class="cython line score-0">&#xA0;<span class="">319</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">320</span>:                 # ----------   Load new vals to state array  ---------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">321</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">322</span>:                 # 'S', 'E', 'Pa', 'Py', 'Ia', 'Iy', 'Ih', 'R', 'D', 'E2P', 'E2Py', 'P2I', 'Pa2Ia', 'Py2Iy', 'Iy2Ih', 'H2D'</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>:                 compt_v[n, a, r, 0] = new_S</pre>
<pre class='cython code score-0 '>                                __pyx_t_19 = __pyx_v_n;
                                __pyx_t_20 = __pyx_v_a;
                                __pyx_t_21 = __pyx_v_r;
                                __pyx_t_23 = 0;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_19 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_20 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_21 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_23 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_S;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:                 compt_v[n, a, r, 1] = new_E</pre>
<pre class='cython code score-0 '>                                __pyx_t_22 = __pyx_v_n;
                                __pyx_t_31 = __pyx_v_a;
                                __pyx_t_32 = __pyx_v_r;
                                __pyx_t_33 = 1;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_22 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_31 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_32 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_33 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_E;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:                 compt_v[n, a, r, 2] = new_Pa</pre>
<pre class='cython code score-0 '>                                __pyx_t_34 = __pyx_v_n;
                                __pyx_t_35 = __pyx_v_a;
                                __pyx_t_36 = __pyx_v_r;
                                __pyx_t_37 = 2;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_34 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_35 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_36 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_37 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_Pa;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:                 compt_v[n, a, r, 3] = new_Py</pre>
<pre class='cython code score-0 '>                                __pyx_t_38 = __pyx_v_n;
                                __pyx_t_39 = __pyx_v_a;
                                __pyx_t_40 = __pyx_v_r;
                                __pyx_t_41 = 3;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_38 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_39 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_40 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_41 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_Py;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:                 compt_v[n, a, r, 4] = new_Ia</pre>
<pre class='cython code score-0 '>                                __pyx_t_42 = __pyx_v_n;
                                __pyx_t_43 = __pyx_v_a;
                                __pyx_t_44 = __pyx_v_r;
                                __pyx_t_45 = 4;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_42 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_43 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_44 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_45 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_Ia;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:                 compt_v[n, a, r, 5] = new_Iy</pre>
<pre class='cython code score-0 '>                                __pyx_t_46 = __pyx_v_n;
                                __pyx_t_47 = __pyx_v_a;
                                __pyx_t_48 = __pyx_v_r;
                                __pyx_t_49 = 5;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_46 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_47 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_48 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_49 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_Iy;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">329</span>:                 compt_v[n, a, r, 6] = new_Ih</pre>
<pre class='cython code score-0 '>                                __pyx_t_50 = __pyx_v_n;
                                __pyx_t_51 = __pyx_v_a;
                                __pyx_t_52 = __pyx_v_r;
                                __pyx_t_53 = 6;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_50 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_51 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_52 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_53 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_Ih;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">330</span>:                 compt_v[n, a, r, 7] = new_R</pre>
<pre class='cython code score-0 '>                                __pyx_t_54 = __pyx_v_n;
                                __pyx_t_55 = __pyx_v_a;
                                __pyx_t_56 = __pyx_v_r;
                                __pyx_t_57 = 7;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_54 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_55 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_56 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_57 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_R;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>:                 compt_v[n, a, r, 8] = new_D</pre>
<pre class='cython code score-0 '>                                __pyx_t_58 = __pyx_v_n;
                                __pyx_t_59 = __pyx_v_a;
                                __pyx_t_60 = __pyx_v_r;
                                __pyx_t_61 = 8;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_58 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_59 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_60 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_61 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_D;
</pre><pre class="cython line score-0">&#xA0;<span class="">332</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>:                 compt_v[n, a, r, 9] = new_E2P</pre>
<pre class='cython code score-0 '>                                __pyx_t_62 = __pyx_v_n;
                                __pyx_t_63 = __pyx_v_a;
                                __pyx_t_64 = __pyx_v_r;
                                __pyx_t_65 = 9;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_62 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_63 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_64 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_65 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_E2P;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:                 compt_v[n, a, r, 10] = new_E2Py</pre>
<pre class='cython code score-0 '>                                __pyx_t_66 = __pyx_v_n;
                                __pyx_t_67 = __pyx_v_a;
                                __pyx_t_68 = __pyx_v_r;
                                __pyx_t_69 = 10;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_66 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_67 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_68 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_69 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_E2Py;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">335</span>:                 compt_v[n, a, r, 11] = new_P2I</pre>
<pre class='cython code score-0 '>                                __pyx_t_70 = __pyx_v_n;
                                __pyx_t_71 = __pyx_v_a;
                                __pyx_t_72 = __pyx_v_r;
                                __pyx_t_73 = 11;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_70 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_71 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_72 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_73 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_P2I;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>:                 compt_v[n, a, r, 12] = new_Pa2Ia</pre>
<pre class='cython code score-0 '>                                __pyx_t_74 = __pyx_v_n;
                                __pyx_t_75 = __pyx_v_a;
                                __pyx_t_76 = __pyx_v_r;
                                __pyx_t_77 = 12;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_74 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_75 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_76 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_77 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_Pa2Ia;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">337</span>:                 compt_v[n, a, r, 13] = new_Py2Iy</pre>
<pre class='cython code score-0 '>                                __pyx_t_78 = __pyx_v_n;
                                __pyx_t_79 = __pyx_v_a;
                                __pyx_t_80 = __pyx_v_r;
                                __pyx_t_81 = 13;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_78 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_79 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_80 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_81 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_Py2Iy;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>:                 compt_v[n, a, r, 14] = new_Iy2Ih</pre>
<pre class='cython code score-0 '>                                __pyx_t_82 = __pyx_v_n;
                                __pyx_t_83 = __pyx_v_a;
                                __pyx_t_84 = __pyx_v_r;
                                __pyx_t_85 = 14;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_82 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_83 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_84 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_85 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_Iy2Ih;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">339</span>:                 compt_v[n, a, r, 15] = new_H2D</pre>
<pre class='cython code score-0 '>                                __pyx_t_86 = __pyx_v_n;
                                __pyx_t_87 = __pyx_v_a;
                                __pyx_t_88 = __pyx_v_r;
                                __pyx_t_89 = 15;
                                *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_compt_v.data + __pyx_t_86 * __pyx_v_compt_v.strides[0]) ) + __pyx_t_87 * __pyx_v_compt_v.strides[1]) ) + __pyx_t_88 * __pyx_v_compt_v.strides[2]) ) + __pyx_t_89 * __pyx_v_compt_v.strides[3]) )) = __pyx_v_new_H2D;
                              }
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>:     return compt_counts</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_compt_counts));
  __pyx_r = __pyx_v_compt_counts;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">341</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">343</span>: cdef np.ndarray SEIR_inter_node(double [:, :, :, :, :] ntwk_v,</pre>
<pre class='cython code score-9 '>static PyArrayObject *__pyx_f_8SEIRcity_5model_8cy_model_SEIR_inter_node(__Pyx_memviewslice __pyx_v_ntwk_v, __Pyx_memviewslice __pyx_v_ew_v, gsl_rng *__pyx_v_rng) {
  Py_ssize_t __pyx_v_node_len;
  Py_ssize_t __pyx_v_age_len;
  Py_ssize_t __pyx_v_risk_len;
  CYTHON_UNUSED Py_ssize_t __pyx_v_vt_len;
  Py_ssize_t __pyx_v_compt_len;
  PyArrayObject *__pyx_v_delta = 0;
  Py_ssize_t __pyx_v_c;
  Py_ssize_t __pyx_v_c2;
  Py_ssize_t __pyx_v_a;
  Py_ssize_t __pyx_v_r;
  Py_ssize_t __pyx_v_ct;
  Py_ssize_t __pyx_v_idx1;
  Py_ssize_t __pyx_v_idx2;
  double __pyx_v_c2_to_c;
  double __pyx_v_deterministic;
  __Pyx_memviewslice __pyx_v_d_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SEIR_inter_node", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("SEIRcity.model.cy_model.SEIR_inter_node", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_delta);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_d_view, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">344</span>:                                 double [:, :] ew_v,</pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>:                                 gsl_rng *rng):</pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>:     # Type setting</pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>:     cdef:</pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>:         # lengths of each dimension in state space</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:         Py_ssize_t node_len = ntwk_v.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_node_len = (__pyx_v_ntwk_v.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:         Py_ssize_t age_len = ntwk_v.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_age_len = (__pyx_v_ntwk_v.shape[1]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:         Py_ssize_t risk_len = ntwk_v.shape[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_risk_len = (__pyx_v_ntwk_v.shape[2]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:         Py_ssize_t vt_len = ntwk_v.shape[3]</pre>
<pre class='cython code score-0 '>  __pyx_v_vt_len = (__pyx_v_ntwk_v.shape[3]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>:         Py_ssize_t compt_len = ntwk_v.shape[4]</pre>
<pre class='cython code score-0 '>  __pyx_v_compt_len = (__pyx_v_ntwk_v.shape[4]);
</pre><pre class="cython line score-0">&#xA0;<span class="">357</span>:         # lengths of each dimension in edge weight array</pre>
<pre class="cython line score-0">&#xA0;<span class="">358</span>:         # int ew_len = ew_v.shape[0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">359</span>:         # output state array. Note that `value_type` dimension is</pre>
<pre class="cython line score-0">&#xA0;<span class="">360</span>:         # removed, since no coordinate other than `counts` is changing</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:         np.ndarray delta = np.zeros(</pre>
<pre class='cython code score-18 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  __pyx_v_delta = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>:             (node_len, age_len, risk_len, compt_len), dtype=DTYPE_FLOAT)</pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_node_len);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_age_len);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_risk_len);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_compt_len);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_5);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
/* … */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE_FLOAT);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">363</span>:         # counters</pre>
<pre class="cython line score-0">&#xA0;<span class="">364</span>:         Py_ssize_t c, c2, a, r, ct, idx1, idx2</pre>
<pre class="cython line score-0">&#xA0;<span class="">365</span>:         double c2_to_c, deterministic</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>:         double [:, :, :, :] d_view = delta</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double</span>(((PyObject *)__pyx_v_delta), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
  __pyx_v_d_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">367</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">368</span>:     # ------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">369</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">370</span>:     # Iterate over every pair of nodes</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:     for c in prange(node_len, nogil=True):</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_8 = __pyx_v_node_len;
        if ((1 == 0)) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_10 = (__pyx_t_8 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_10 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_a) firstprivate(__pyx_v_c) lastprivate(__pyx_v_c) lastprivate(__pyx_v_c2) lastprivate(__pyx_v_c2_to_c) lastprivate(__pyx_v_ct) lastprivate(__pyx_v_deterministic) lastprivate(__pyx_v_idx1) lastprivate(__pyx_v_idx2) lastprivate(__pyx_v_r)
                    #endif /* _OPENMP */
                    for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_10; __pyx_t_9++){
                        {
                            __pyx_v_c = (Py_ssize_t)(0 + 1 * __pyx_t_9);
                            /* Initialize private variables to invalid values */
                            __pyx_v_a = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_c2 = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_c2_to_c = ((double)__PYX_NAN());
                            __pyx_v_ct = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_deterministic = ((double)__PYX_NAN());
                            __pyx_v_idx1 = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_idx2 = ((Py_ssize_t)0xbad0bad0);
                            __pyx_v_r = ((Py_ssize_t)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">372</span>:     # for c in range(node_len):</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:         for c2 in range(node_len):</pre>
<pre class='cython code score-0 '>                            __pyx_t_11 = __pyx_v_node_len;
                            __pyx_t_12 = __pyx_t_11;
                            for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
                              __pyx_v_c2 = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">374</span>:             # No migration within node (`c` == `c2`), and ensure that</pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>:             # each unique pair of nodes is iterated only once.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>:             if c2 &lt;= c:</pre>
<pre class='cython code score-0 '>                              __pyx_t_14 = ((__pyx_v_c2 &lt;= __pyx_v_c) != 0);
                              if (__pyx_t_14) {
/* … */
                              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:                 continue</pre>
<pre class='cython code score-0 '>                                goto __pyx_L10_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">378</span>:             # Refresh the views on cities, to incorporate changes made</pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>:             # during previous iterations on node `c` or `c2`</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:             for a in range(age_len):</pre>
<pre class='cython code score-0 '>                              __pyx_t_15 = __pyx_v_age_len;
                              __pyx_t_16 = __pyx_t_15;
                              for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
                                __pyx_v_a = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">381</span>:                 for r in range(risk_len):</pre>
<pre class='cython code score-0 '>                                __pyx_t_18 = __pyx_v_risk_len;
                                __pyx_t_19 = __pyx_t_18;
                                for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
                                  __pyx_v_r = __pyx_t_20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>:                     for ct in range(compt_len):</pre>
<pre class='cython code score-0 '>                                  __pyx_t_21 = __pyx_v_compt_len;
                                  __pyx_t_22 = __pyx_t_21;
                                  for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
                                    __pyx_v_ct = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">383</span>:                         # Get indices along EdgeWtAccessor array</pre>
<pre class="cython line score-0">&#xA0;<span class="">384</span>:                         idx1 = (c * age_len * risk_len * compt_len) + \</pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>:                             (a * risk_len * compt_len) + \</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:                             (r * compt_len) + ct</pre>
<pre class='cython code score-0 '>                                    __pyx_v_idx1 = ((((((__pyx_v_c * __pyx_v_age_len) * __pyx_v_risk_len) * __pyx_v_compt_len) + ((__pyx_v_a * __pyx_v_risk_len) * __pyx_v_compt_len)) + (__pyx_v_r * __pyx_v_compt_len)) + __pyx_v_ct);
</pre><pre class="cython line score-0">&#xA0;<span class="">387</span>:                         idx2 = (c2 * age_len * risk_len * compt_len) + \</pre>
<pre class="cython line score-0">&#xA0;<span class="">388</span>:                             (a * risk_len * compt_len) + \</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">389</span>:                             (r * compt_len) + ct</pre>
<pre class='cython code score-0 '>                                    __pyx_v_idx2 = ((((((__pyx_v_c2 * __pyx_v_age_len) * __pyx_v_risk_len) * __pyx_v_compt_len) + ((__pyx_v_a * __pyx_v_risk_len) * __pyx_v_compt_len)) + (__pyx_v_r * __pyx_v_compt_len)) + __pyx_v_ct);
</pre><pre class="cython line score-0">&#xA0;<span class="">390</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">391</span>:                         # For this compartment, net migration from c2 to c1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:                         c2_to_c = (ntwk_v[c2, a, r, 0, ct] * ew_v[idx1, idx2]) - \</pre>
<pre class='cython code score-0 '>                                    __pyx_t_24 = __pyx_v_c2;
                                    __pyx_t_25 = __pyx_v_a;
                                    __pyx_t_26 = __pyx_v_r;
                                    __pyx_t_27 = 0;
                                    __pyx_t_28 = __pyx_v_ct;
                                    __pyx_t_29 = __pyx_v_idx1;
                                    __pyx_t_30 = __pyx_v_idx2;
/* … */
                                    __pyx_v_c2_to_c = (((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_24 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_25 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_26 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_27 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_28 * __pyx_v_ntwk_v.strides[4]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ew_v.data + __pyx_t_29 * __pyx_v_ew_v.strides[0]) ) + __pyx_t_30 * __pyx_v_ew_v.strides[1]) )))) - ((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_31 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_32 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_33 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_34 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_35 * __pyx_v_ntwk_v.strides[4]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ew_v.data + __pyx_t_36 * __pyx_v_ew_v.strides[0]) ) + __pyx_t_37 * __pyx_v_ew_v.strides[1]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">393</span>:                             (ntwk_v[c, a, r, 0, ct] * ew_v[idx2, idx1])</pre>
<pre class='cython code score-0 '>                                    __pyx_t_31 = __pyx_v_c;
                                    __pyx_t_32 = __pyx_v_a;
                                    __pyx_t_33 = __pyx_v_r;
                                    __pyx_t_34 = 0;
                                    __pyx_t_35 = __pyx_v_ct;
                                    __pyx_t_36 = __pyx_v_idx2;
                                    __pyx_t_37 = __pyx_v_idx1;
</pre><pre class="cython line score-0">&#xA0;<span class="">394</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">395</span>:                         # Handle stochasticity if specified</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">396</span>:                         deterministic = ntwk_v[c, a, r, 13, ct]</pre>
<pre class='cython code score-0 '>                                    __pyx_t_37 = __pyx_v_c;
                                    __pyx_t_36 = __pyx_v_a;
                                    __pyx_t_35 = __pyx_v_r;
                                    __pyx_t_34 = 13;
                                    __pyx_t_33 = __pyx_v_ct;
                                    __pyx_v_deterministic = (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_37 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_36 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_35 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_34 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_33 * __pyx_v_ntwk_v.strides[4]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>:                         if deterministic == 0:</pre>
<pre class='cython code score-0 '>                                    __pyx_t_14 = ((__pyx_v_deterministic == 0.0) != 0);
                                    if (__pyx_t_14) {
/* … */
                                    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">398</span>:                             if c2_to_c &lt; 0:</pre>
<pre class='cython code score-0 '>                                      __pyx_t_14 = ((__pyx_v_c2_to_c &lt; 0.0) != 0);
                                      if (__pyx_t_14) {
/* … */
                                        goto __pyx_L20;
                                      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:                                 c2_to_c = gsl_ran_poisson(rng, -c2_to_c)</pre>
<pre class='cython code score-0 '>                                        __pyx_v_c2_to_c = gsl_ran_poisson(__pyx_v_rng, (-__pyx_v_c2_to_c));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:                                 c2_to_c = -c2_to_c</pre>
<pre class='cython code score-0 '>                                        __pyx_v_c2_to_c = (-__pyx_v_c2_to_c);
</pre><pre class="cython line score-0">&#xA0;<span class="">401</span>:                             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:                                 c2_to_c = gsl_ran_poisson(rng, c2_to_c)</pre>
<pre class='cython code score-0 '>                                      /*else*/ {
                                        __pyx_v_c2_to_c = gsl_ran_poisson(__pyx_v_rng, __pyx_v_c2_to_c);
                                      }
                                      __pyx_L20:;
</pre><pre class="cython line score-0">&#xA0;<span class="">403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">404</span>:                         # Ensure that no compartments will have negative</pre>
<pre class="cython line score-0">&#xA0;<span class="">405</span>:                         # values, while ensuring that the total sum of</pre>
<pre class="cython line score-0">&#xA0;<span class="">406</span>:                         # the delta array is zero</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">407</span>:                         if (d_view[c, a, r, ct] + c2_to_c + ntwk_v[c, a, r, 0, ct]) &lt; 0:</pre>
<pre class='cython code score-0 '>                                    __pyx_t_33 = __pyx_v_c;
                                    __pyx_t_34 = __pyx_v_a;
                                    __pyx_t_35 = __pyx_v_r;
                                    __pyx_t_36 = __pyx_v_ct;
                                    __pyx_t_37 = __pyx_v_c;
                                    __pyx_t_32 = __pyx_v_a;
                                    __pyx_t_31 = __pyx_v_r;
                                    __pyx_t_30 = 0;
                                    __pyx_t_29 = __pyx_v_ct;
                                    __pyx_t_14 = (((((*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_33 * __pyx_v_d_view.strides[0]) ) + __pyx_t_34 * __pyx_v_d_view.strides[1]) ) + __pyx_t_35 * __pyx_v_d_view.strides[2]) ) + __pyx_t_36 * __pyx_v_d_view.strides[3]) ))) + __pyx_v_c2_to_c) + (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_37 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_32 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_31 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_30 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_29 * __pyx_v_ntwk_v.strides[4]) )))) &lt; 0.0) != 0);
                                    if (__pyx_t_14) {
/* … */
                                      goto __pyx_L21;
                                    }
</pre><pre class="cython line score-0">&#xA0;<span class="">408</span>:                             # node `c` would be negative</pre>
<pre class="cython line score-0">&#xA0;<span class="">409</span>:                             # logging.error(f"new_delt_c: {new_delt_c}")</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">410</span>:                             c2_to_c = -ntwk_v[c, a, r, 0, ct] - d_view[c, a, r, ct]</pre>
<pre class='cython code score-0 '>                                      __pyx_t_29 = __pyx_v_c;
                                      __pyx_t_30 = __pyx_v_a;
                                      __pyx_t_31 = __pyx_v_r;
                                      __pyx_t_32 = 0;
                                      __pyx_t_37 = __pyx_v_ct;
                                      __pyx_t_36 = __pyx_v_c;
                                      __pyx_t_35 = __pyx_v_a;
                                      __pyx_t_34 = __pyx_v_r;
                                      __pyx_t_33 = __pyx_v_ct;
                                      __pyx_v_c2_to_c = ((-(*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_29 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_30 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_31 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_32 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_37 * __pyx_v_ntwk_v.strides[4]) )))) - (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_36 * __pyx_v_d_view.strides[0]) ) + __pyx_t_35 * __pyx_v_d_view.strides[1]) ) + __pyx_t_34 * __pyx_v_d_view.strides[2]) ) + __pyx_t_33 * __pyx_v_d_view.strides[3]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">411</span>:                         elif (d_view[c2, a, r, ct] - c2_to_c + ntwk_v[c2, a, r, 0, ct]) &lt; 0:</pre>
<pre class='cython code score-0 '>                                    __pyx_t_33 = __pyx_v_c2;
                                    __pyx_t_34 = __pyx_v_a;
                                    __pyx_t_35 = __pyx_v_r;
                                    __pyx_t_36 = __pyx_v_ct;
                                    __pyx_t_37 = __pyx_v_c2;
                                    __pyx_t_32 = __pyx_v_a;
                                    __pyx_t_31 = __pyx_v_r;
                                    __pyx_t_30 = 0;
                                    __pyx_t_29 = __pyx_v_ct;
                                    __pyx_t_14 = (((((*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_33 * __pyx_v_d_view.strides[0]) ) + __pyx_t_34 * __pyx_v_d_view.strides[1]) ) + __pyx_t_35 * __pyx_v_d_view.strides[2]) ) + __pyx_t_36 * __pyx_v_d_view.strides[3]) ))) - __pyx_v_c2_to_c) + (*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_37 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_32 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_31 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_30 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_29 * __pyx_v_ntwk_v.strides[4]) )))) &lt; 0.0) != 0);
                                    if (__pyx_t_14) {
/* … */
                                    }
                                    __pyx_L21:;
</pre><pre class="cython line score-0">&#xA0;<span class="">412</span>:                             # node `c2` would be negative</pre>
<pre class="cython line score-0">&#xA0;<span class="">413</span>:                             # logging.error(f"new_delt_c2: {new_delt_c2}")</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">414</span>:                             c2_to_c = ntwk_v[c2, a, r, 0, ct] + d_view[c2, a, r, ct]</pre>
<pre class='cython code score-0 '>                                      __pyx_t_29 = __pyx_v_c2;
                                      __pyx_t_30 = __pyx_v_a;
                                      __pyx_t_31 = __pyx_v_r;
                                      __pyx_t_32 = 0;
                                      __pyx_t_37 = __pyx_v_ct;
                                      __pyx_t_36 = __pyx_v_c2;
                                      __pyx_t_35 = __pyx_v_a;
                                      __pyx_t_34 = __pyx_v_r;
                                      __pyx_t_33 = __pyx_v_ct;
                                      __pyx_v_c2_to_c = ((*((double *) ( /* dim=4 */ (( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ntwk_v.data + __pyx_t_29 * __pyx_v_ntwk_v.strides[0]) ) + __pyx_t_30 * __pyx_v_ntwk_v.strides[1]) ) + __pyx_t_31 * __pyx_v_ntwk_v.strides[2]) ) + __pyx_t_32 * __pyx_v_ntwk_v.strides[3]) ) + __pyx_t_37 * __pyx_v_ntwk_v.strides[4]) ))) + (*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_36 * __pyx_v_d_view.strides[0]) ) + __pyx_t_35 * __pyx_v_d_view.strides[1]) ) + __pyx_t_34 * __pyx_v_d_view.strides[2]) ) + __pyx_t_33 * __pyx_v_d_view.strides[3]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">415</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">416</span>:                         # Update the delta array</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">417</span>:                         d_view[c, a, r, ct] += c2_to_c</pre>
<pre class='cython code score-0 '>                                    __pyx_t_33 = __pyx_v_c;
                                    __pyx_t_34 = __pyx_v_a;
                                    __pyx_t_35 = __pyx_v_r;
                                    __pyx_t_36 = __pyx_v_ct;
                                    *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_33 * __pyx_v_d_view.strides[0]) ) + __pyx_t_34 * __pyx_v_d_view.strides[1]) ) + __pyx_t_35 * __pyx_v_d_view.strides[2]) ) + __pyx_t_36 * __pyx_v_d_view.strides[3]) )) += __pyx_v_c2_to_c;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">418</span>:                         d_view[c2, a, r, ct] -= c2_to_c</pre>
<pre class='cython code score-0 '>                                    __pyx_t_37 = __pyx_v_c2;
                                    __pyx_t_32 = __pyx_v_a;
                                    __pyx_t_31 = __pyx_v_r;
                                    __pyx_t_30 = __pyx_v_ct;
                                    *((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_37 * __pyx_v_d_view.strides[0]) ) + __pyx_t_32 * __pyx_v_d_view.strides[1]) ) + __pyx_t_31 * __pyx_v_d_view.strides[2]) ) + __pyx_t_30 * __pyx_v_d_view.strides[3]) )) -= __pyx_v_c2_to_c;
                                  }
                                }
                              }
                              __pyx_L10_continue:;
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">419</span>:     return delta</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_delta));
  __pyx_r = __pyx_v_delta;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">420</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">421</span>: </pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">422</span>: def SEIR_simulate_network(np.ndarray simspace_arr, np.ndarray edge_wt_arr,</pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_8SEIRcity_5model_8cy_model_3SEIR_simulate_network(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_8SEIRcity_5model_8cy_model_2SEIR_simulate_network[] = "\n    ";
static PyMethodDef __pyx_mdef_8SEIRcity_5model_8cy_model_3SEIR_simulate_network = {"SEIR_simulate_network", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8SEIRcity_5model_8cy_model_3SEIR_simulate_network, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8SEIRcity_5model_8cy_model_2SEIR_simulate_network};
static PyObject *__pyx_pw_8SEIRcity_5model_8cy_model_3SEIR_simulate_network(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_simspace_arr = 0;
  PyArrayObject *__pyx_v_edge_wt_arr = 0;
  PyArrayObject *__pyx_v_phi_arr = 0;
  PyArrayObject *__pyx_v_time_coords = 0;
  int __pyx_v_int_seed;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SEIR_simulate_network (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_simspace_arr,&amp;__pyx_n_s_edge_wt_arr,&amp;__pyx_n_s_phi_arr,&amp;__pyx_n_s_time_coords,&amp;__pyx_n_s_int_seed,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_simspace_arr)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_edge_wt_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SEIR_simulate_network", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_phi_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SEIR_simulate_network", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_time_coords)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SEIR_simulate_network", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_int_seed)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SEIR_simulate_network", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "SEIR_simulate_network") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_simspace_arr = ((PyArrayObject *)values[0]);
    __pyx_v_edge_wt_arr = ((PyArrayObject *)values[1]);
    __pyx_v_phi_arr = ((PyArrayObject *)values[2]);
    __pyx_v_time_coords = ((PyArrayObject *)values[3]);
    __pyx_v_int_seed = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_int_seed == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 424, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("SEIR_simulate_network", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("SEIRcity.model.cy_model.SEIR_simulate_network", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_ptype_5numpy_ndarray, 1, "simspace_arr", 0))) <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_edge_wt_arr), __pyx_ptype_5numpy_ndarray, 1, "edge_wt_arr", 0))) <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_phi_arr), __pyx_ptype_5numpy_ndarray, 1, "phi_arr", 0))) <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_time_coords), __pyx_ptype_5numpy_ndarray, 1, "time_coords", 0))) <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8SEIRcity_5model_8cy_model_2SEIR_simulate_network(__pyx_self, __pyx_v_simspace_arr, __pyx_v_edge_wt_arr, __pyx_v_phi_arr, __pyx_v_time_coords, __pyx_v_int_seed);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8SEIRcity_5model_8cy_model_2SEIR_simulate_network(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_simspace_arr, PyArrayObject *__pyx_v_edge_wt_arr, PyArrayObject *__pyx_v_phi_arr, PyArrayObject *__pyx_v_time_coords, int __pyx_v_int_seed) {
  gsl_rng *__pyx_v_rng;
  Py_ssize_t __pyx_v_time_len;
  CYTHON_UNUSED Py_ssize_t __pyx_v_node_len;
  unsigned int __pyx_v_enable_network;
  unsigned int __pyx_v_enable_SEIR;
  PyArrayObject *__pyx_v_delta = 0;
  double __pyx_v_int_per_day;
  int __pyx_v_t;
  CYTHON_UNUSED double __pyx_v_tol;
  __Pyx_memviewslice __pyx_v_ntwk_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ew_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_phi_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SEIR_simulate_network", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("SEIRcity.model.cy_model.SEIR_simulate_network", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_delta);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ntwk_view, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ew_view, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_phi_view, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(19, __pyx_n_s_simspace_arr, __pyx_n_s_edge_wt_arr, __pyx_n_s_phi_arr, __pyx_n_s_time_coords, __pyx_n_s_int_seed, __pyx_n_s_rng, __pyx_n_s_time_len, __pyx_n_s_node_len, __pyx_n_s_enable_network, __pyx_n_s_enable_SEIR, __pyx_n_s_delta, __pyx_n_s_int_per_day, __pyx_n_s_t, __pyx_n_s_c, __pyx_n_s_tol, __pyx_n_s_ntwk_view, __pyx_n_s_ew_view, __pyx_n_s_phi_view, __pyx_n_s_int_per_day_view);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 422, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_8SEIRcity_5model_8cy_model_3SEIR_simulate_network, NULL, __pyx_n_s_SEIRcity_model_cy_model);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_SEIR_simulate_network, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 422, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__32 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_SEIRcity_model_cy_model_pyx, __pyx_n_s_SEIR_simulate_network, 422, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 422, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">423</span>:                           np.ndarray phi_arr, np.ndarray time_coords,</pre>
<pre class="cython line score-0">&#xA0;<span class="">424</span>:                           int int_seed):</pre>
<pre class="cython line score-0">&#xA0;<span class="">425</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">426</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">427</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">428</span>:     # Type setting</pre>
<pre class="cython line score-0">&#xA0;<span class="">429</span>:     cdef:</pre>
<pre class="cython line score-0">&#xA0;<span class="">430</span>:         # GSL random number generator</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">431</span>:         gsl_rng *rng = get_seeded_rng(int_seed)</pre>
<pre class='cython code score-0 '>  __pyx_v_rng = __pyx_f_8SEIRcity_5model_8cy_model_get_seeded_rng(__pyx_v_int_seed);
</pre><pre class="cython line score-0">&#xA0;<span class="">432</span>:         # lengths of each sim space dimension</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">433</span>:         Py_ssize_t time_len = simspace_arr.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_time_len = (__pyx_v_simspace_arr-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">434</span>:         Py_ssize_t node_len = simspace_arr.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_node_len = (__pyx_v_simspace_arr-&gt;dimensions[1]);
</pre><pre class="cython line score-0">&#xA0;<span class="">435</span>:         # boolean flag to determine whether to calculate inter node</pre>
<pre class="cython line score-0">&#xA0;<span class="">436</span>:         # dynamics. Auto-sets to 0 if all edge weights are 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">437</span>:         unsigned int enable_network</pre>
<pre class="cython line score-0">&#xA0;<span class="">438</span>:         # boolean flag to determine whether to calculate SEIR transmission.</pre>
<pre class="cython line score-0">&#xA0;<span class="">439</span>:         # Auto-sets to 0 if all 'beta0' values are 0.</pre>
<pre class="cython line score-0">&#xA0;<span class="">440</span>:         unsigned int enable_SEIR</pre>
<pre class="cython line score-0">&#xA0;<span class="">441</span>:         # array of compartment changes for one timepoint</pre>
<pre class="cython line score-0">&#xA0;<span class="">442</span>:         np.ndarray delta</pre>
<pre class="cython line score-0">&#xA0;<span class="">443</span>:         # Interval per day is defined as the reciprocal of the timedelta in days</pre>
<pre class="cython line score-0">&#xA0;<span class="">444</span>:         # between timepoints t and t + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">445</span>:         double int_per_day</pre>
<pre class="cython line score-0">&#xA0;<span class="">446</span>:         # counters</pre>
<pre class="cython line score-0">&#xA0;<span class="">447</span>:         int t, c</pre>
<pre class="cython line score-0">&#xA0;<span class="">448</span>:         # DEBUG</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">449</span>:         double tol = 1e-6</pre>
<pre class='cython code score-0 '>  __pyx_v_tol = 1e-6;
</pre><pre class="cython line score-0">&#xA0;<span class="">450</span>:         # memory views of ndarrays</pre>
<pre class="cython line score-0">&#xA0;<span class="">451</span>:         double [:, :, :, :, :] ntwk_view</pre>
<pre class="cython line score-0">&#xA0;<span class="">452</span>:         double [:, :] ew_view</pre>
<pre class="cython line score-0">&#xA0;<span class="">453</span>:         double [:, :] phi_view</pre>
<pre class="cython line score-0">&#xA0;<span class="">454</span>:         double [:] int_per_day_view</pre>
<pre class="cython line score-0">&#xA0;<span class="">455</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">456</span>:     # ------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">458</span>:     # Disable SEIR model entirely if all beta0 values (value_type index 1 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">459</span>:     # are zero</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:     if np.all(simspace_arr[:, :, :, :, 1, :] == 0):</pre>
<pre class='cython code score-38 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_all);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__2 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__2)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_tuple__3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_2, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L3;
  }
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_slice__2, __pyx_slice__2, __pyx_slice__2, __pyx_slice__2, __pyx_int_1, __pyx_slice__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">461</span>:         enable_SEIR = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_enable_SEIR = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:         logging.debug("`enable_SEIR` == False. All 'beta0' on axis " +</pre>
<pre class='cython code score-20 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_debug);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_kp_u_enable_SEIR_False_All_beta0_on) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_kp_u_enable_SEIR_False_All_beta0_on);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">463</span>:                       "'value_type' are zero.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">464</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">465</span>:         enable_SEIR = 1</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_enable_SEIR = 1;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">466</span>:         logging.debug("`enable_SEIR` == True. Not all 'beta0' on axis " +</pre>
<pre class='cython code score-20 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_debug);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_kp_u_enable_SEIR_True_Not_all_beta0) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_kp_u_enable_SEIR_True_Not_all_beta0);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">467</span>:                       "'value_type' are zero.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">468</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">469</span>:     # Network dynamics never need to be calculated in SEIR_inter_node</pre>
<pre class="cython line score-0">&#xA0;<span class="">470</span>:     # if all edge weights are zero</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:     if np.all(edge_wt_arr == 0):</pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 471, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_all);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 471, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_edge_wt_arr), __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 471, __pyx_L1_error)</span>
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">472</span>:         enable_network = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_enable_network = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:         logging.debug("`enable_network` == False. Simulating each node " +</pre>
<pre class='cython code score-20 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_debug);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_kp_u_enable_network_False_Simulating) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_kp_u_enable_network_False_Simulating);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 473, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">474</span>:                       "separately.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">475</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>:         enable_network = 1</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_enable_network = 1;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>:         logging.debug("`enable_network` == True. Will calculate network " +</pre>
<pre class='cython code score-20 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_debug);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_kp_u_enable_network_True_Will_calcul) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_kp_u_enable_network_True_Will_calcul);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 477, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">478</span>:                       "dynamics at every timepoint.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">479</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">480</span>:     # ------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">481</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">482</span>:     # iterate over timepoints</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>:     for t in range(time_len - 1):</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (__pyx_v_time_len - 1);
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_t = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">484</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">485</span>:         # Get interval per day</pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>:         int_per_day = np.timedelta64(1, 'D') / (time_coords[t+1] - time_coords[t])</pre>
<pre class='cython code score-39 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_timedelta64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = (__pyx_v_t + 1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_time_coords), __pyx_t_9, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_time_coords), __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_10 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_int_per_day = __pyx_t_10;
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_n_u_D);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class="cython line score-0">&#xA0;<span class="">487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">488</span>:         # Run canonical SEIR model for each city</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:         if enable_SEIR != 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = ((__pyx_v_enable_SEIR != 0) != 0);
    if (__pyx_t_5) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:             ntwk_view = simspace_arr[t]</pre>
<pre class='cython code score-5 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ntwk_view, 1);
      __pyx_v_ntwk_view = __pyx_t_11;
      __pyx_t_11.memview = NULL;
      __pyx_t_11.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:             phi_view = phi_arr[t]</pre>
<pre class='cython code score-5 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_phi_arr), __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_phi_view, 1);
      __pyx_v_phi_view = __pyx_t_12;
      __pyx_t_12.memview = NULL;
      __pyx_t_12.data = NULL;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:             simspace_arr[t + 1, :, :, :, 0, :] = SEIR_intra_node(</pre>
<pre class='cython code score-25 '>      __pyx_t_3 = ((PyObject *)__pyx_f_8SEIRcity_5model_8cy_model_SEIR_intra_node(__pyx_v_ntwk_view, __pyx_v_phi_view, __pyx_v_int_per_day, __pyx_v_rng));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_t + 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 492, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_slice__2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_slice__2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, __pyx_slice__2);
      __pyx_t_2 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_t_1, __pyx_t_3) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 492, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">493</span>:                 ntwk_view, phi_view, int_per_day, rng)</pre>
<pre class="cython line score-0">&#xA0;<span class="">494</span>:         else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">495</span>:             simspace_arr[t + 1] = simspace_arr[t]</pre>
<pre class='cython code score-5 '>    /*else*/ {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_v_t, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_9 = (__pyx_v_t + 1);
      if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_t_9, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 495, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">497</span>:         # Apply migration between city nodes. Migration occurs every</pre>
<pre class="cython line score-0">&#xA0;<span class="">498</span>:         # timepoint. Skip if all edge weights are zero.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">499</span>:         if enable_network != 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = ((__pyx_v_enable_network != 0) != 0);
    if (__pyx_t_5) {
/* … */
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">500</span>:             ew_view = edge_wt_arr</pre>
<pre class='cython code score-2 '>      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(((PyObject *)__pyx_v_edge_wt_arr), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 500, __pyx_L1_error)</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ew_view, 1);
      __pyx_v_ew_view = __pyx_t_12;
      __pyx_t_12.memview = NULL;
      __pyx_t_12.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>:             ntwk_view = simspace_arr[t + 1]</pre>
<pre class='cython code score-5 '>      __pyx_t_9 = (__pyx_v_t + 1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_t_9, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 501, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsdsdsds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 501, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ntwk_view, 1);
      __pyx_v_ntwk_view = __pyx_t_11;
      __pyx_t_11.memview = NULL;
      __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">502</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">503</span>:             # Get number of people in each bin that migrated to city `c`</pre>
<pre class="cython line score-0">&#xA0;<span class="">504</span>:             # Note that `value_type` dimension is set to 'count'</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">505</span>:             delta = SEIR_inter_node(ntwk_view, ew_view, rng)</pre>
<pre class='cython code score-1 '>      __pyx_t_3 = ((PyObject *)__pyx_f_8SEIRcity_5model_8cy_model_SEIR_inter_node(__pyx_v_ntwk_view, __pyx_v_ew_view, __pyx_v_rng));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_delta, ((PyArrayObject *)__pyx_t_3));
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">506</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">507</span>:             # no performance footprint</pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">508</span>:             simspace_arr[t + 1, :, :, :, 0, :] += delta</pre>
<pre class='cython code score-33 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_t + 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_slice__2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_slice__2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, __pyx_slice__2);
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_3, ((PyObject *)__pyx_v_delta));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_simspace_arr), __pyx_t_1, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">509</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>:     return simspace_arr</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_simspace_arr));
  __pyx_r = ((PyObject *)__pyx_v_simspace_arr);
  goto __pyx_L0;
</pre></div></body></html>
